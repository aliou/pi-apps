import{a as t,p as e,w as E}from"./chunk-JZWAC4HX-C2HxCtkE.js";import{p as H}from"./IconBase.es-DtVVdnrS.js";import{c as v}from"./CheckCircle.es-CZVH0G_K.js";import{c as g}from"./CircleNotch.es-BrrwzY_j.js";import{r as w}from"./Trash.es-ClMuyJ1A.js";import{e as N}from"./WarningCircle.es-B45BJtDC.js";import{c as p}from"./utils-fNskMoFt.js";import{a as h}from"./api-D4ha4czi.js";const y=new Map([["bold",t.createElement(t.Fragment,null,t.createElement("path",{d:"M228,104a12,12,0,0,1-24,0V69l-59.51,59.51a12,12,0,0,1-17-17L187,52H152a12,12,0,0,1,0-24h64a12,12,0,0,1,12,12Zm-44,24a12,12,0,0,0-12,12v64H52V84h64a12,12,0,0,0,0-24H48A20,20,0,0,0,28,80V208a20,20,0,0,0,20,20H176a20,20,0,0,0,20-20V140A12,12,0,0,0,184,128Z"}))],["duotone",t.createElement(t.Fragment,null,t.createElement("path",{d:"M184,80V208a8,8,0,0,1-8,8H48a8,8,0,0,1-8-8V80a8,8,0,0,1,8-8H176A8,8,0,0,1,184,80Z",opacity:"0.2"}),t.createElement("path",{d:"M224,104a8,8,0,0,1-16,0V59.32l-66.33,66.34a8,8,0,0,1-11.32-11.32L196.68,48H152a8,8,0,0,1,0-16h64a8,8,0,0,1,8,8Zm-40,24a8,8,0,0,0-8,8v72H48V80h72a8,8,0,0,0,0-16H48A16,16,0,0,0,32,80V208a16,16,0,0,0,16,16H176a16,16,0,0,0,16-16V136A8,8,0,0,0,184,128Z"}))],["fill",t.createElement(t.Fragment,null,t.createElement("path",{d:"M192,136v72a16,16,0,0,1-16,16H48a16,16,0,0,1-16-16V80A16,16,0,0,1,48,64h72a8,8,0,0,1,0,16H48V208H176V136a8,8,0,0,1,16,0Zm32-96a8,8,0,0,0-8-8H152a8,8,0,0,0-5.66,13.66L172.69,72l-42.35,42.34a8,8,0,0,0,11.32,11.32L184,83.31l26.34,26.35A8,8,0,0,0,224,104Z"}))],["light",t.createElement(t.Fragment,null,t.createElement("path",{d:"M222,104a6,6,0,0,1-12,0V54.49l-69.75,69.75a6,6,0,0,1-8.48-8.48L201.51,46H152a6,6,0,0,1,0-12h64a6,6,0,0,1,6,6Zm-38,26a6,6,0,0,0-6,6v72a2,2,0,0,1-2,2H48a2,2,0,0,1-2-2V80a2,2,0,0,1,2-2h72a6,6,0,0,0,0-12H48A14,14,0,0,0,34,80V208a14,14,0,0,0,14,14H176a14,14,0,0,0,14-14V136A6,6,0,0,0,184,130Z"}))],["regular",t.createElement(t.Fragment,null,t.createElement("path",{d:"M224,104a8,8,0,0,1-16,0V59.32l-66.33,66.34a8,8,0,0,1-11.32-11.32L196.68,48H152a8,8,0,0,1,0-16h64a8,8,0,0,1,8,8Zm-40,24a8,8,0,0,0-8,8v72H48V80h72a8,8,0,0,0,0-16H48A16,16,0,0,0,32,80V208a16,16,0,0,0,16,16H176a16,16,0,0,0,16-16V136A8,8,0,0,0,184,128Z"}))],["thin",t.createElement(t.Fragment,null,t.createElement("path",{d:"M220,104a4,4,0,0,1-8,0V49.66l-73.16,73.17a4,4,0,0,1-5.66-5.66L206.34,44H152a4,4,0,0,1,0-8h64a4,4,0,0,1,4,4Zm-36,28a4,4,0,0,0-4,4v72a4,4,0,0,1-4,4H48a4,4,0,0,1-4-4V80a4,4,0,0,1,4-4h72a4,4,0,0,0,0-8H48A12,12,0,0,0,36,80V208a12,12,0,0,0,12,12H176a12,12,0,0,0,12-12V136A4,4,0,0,0,184,132Z"}))]]),M=new Map([["bold",t.createElement(t.Fragment,null,t.createElement("path",{d:"M208,76H180V56A52,52,0,0,0,76,56V76H48A20,20,0,0,0,28,96V208a20,20,0,0,0,20,20H208a20,20,0,0,0,20-20V96A20,20,0,0,0,208,76ZM100,56a28,28,0,0,1,56,0V76H100ZM204,204H52V100H204Zm-76-92a32,32,0,0,0-12,61.66V180a12,12,0,0,0,24,0v-6.34A32,32,0,0,0,128,112Zm0,24a8,8,0,1,1-8,8A8,8,0,0,1,128,136Z"}))],["duotone",t.createElement(t.Fragment,null,t.createElement("path",{d:"M208,88H48a8,8,0,0,0-8,8V208a8,8,0,0,0,8,8H208a8,8,0,0,0,8-8V96A8,8,0,0,0,208,88Zm-80,72a20,20,0,1,1,20-20A20,20,0,0,1,128,160Z",opacity:"0.2"}),t.createElement("path",{d:"M208,80H176V56a48,48,0,0,0-96,0V80H48A16,16,0,0,0,32,96V208a16,16,0,0,0,16,16H208a16,16,0,0,0,16-16V96A16,16,0,0,0,208,80ZM96,56a32,32,0,0,1,64,0V80H96ZM208,208H48V96H208V208Zm-80-96a28,28,0,0,0-8,54.83V184a8,8,0,0,0,16,0V166.83A28,28,0,0,0,128,112Zm0,40a12,12,0,1,1,12-12A12,12,0,0,1,128,152Z"}))],["fill",t.createElement(t.Fragment,null,t.createElement("path",{d:"M208,80H176V56a48,48,0,0,0-96,0V80H48A16,16,0,0,0,32,96V208a16,16,0,0,0,16,16H208a16,16,0,0,0,16-16V96A16,16,0,0,0,208,80Zm-72,78.63V184a8,8,0,0,1-16,0V158.63a24,24,0,1,1,16,0ZM160,80H96V56a32,32,0,0,1,64,0Z"}))],["light",t.createElement(t.Fragment,null,t.createElement("path",{d:"M208,82H174V56a46,46,0,0,0-92,0V82H48A14,14,0,0,0,34,96V208a14,14,0,0,0,14,14H208a14,14,0,0,0,14-14V96A14,14,0,0,0,208,82ZM94,56a34,34,0,0,1,68,0V82H94ZM210,208a2,2,0,0,1-2,2H48a2,2,0,0,1-2-2V96a2,2,0,0,1,2-2H208a2,2,0,0,1,2,2Zm-82-94a26,26,0,0,0-6,51.29V184a6,6,0,0,0,12,0V165.29A26,26,0,0,0,128,114Zm0,40a14,14,0,1,1,14-14A14,14,0,0,1,128,154Z"}))],["regular",t.createElement(t.Fragment,null,t.createElement("path",{d:"M128,112a28,28,0,0,0-8,54.83V184a8,8,0,0,0,16,0V166.83A28,28,0,0,0,128,112Zm0,40a12,12,0,1,1,12-12A12,12,0,0,1,128,152Zm80-72H176V56a48,48,0,0,0-96,0V80H48A16,16,0,0,0,32,96V208a16,16,0,0,0,16,16H208a16,16,0,0,0,16-16V96A16,16,0,0,0,208,80ZM96,56a32,32,0,0,1,64,0V80H96ZM208,208H48V96H208V208Z"}))],["thin",t.createElement(t.Fragment,null,t.createElement("path",{d:"M208,84H172V56a44,44,0,0,0-88,0V84H48A12,12,0,0,0,36,96V208a12,12,0,0,0,12,12H208a12,12,0,0,0,12-12V96A12,12,0,0,0,208,84ZM92,56a36,36,0,0,1,72,0V84H92ZM212,208a4,4,0,0,1-4,4H48a4,4,0,0,1-4-4V96a4,4,0,0,1,4-4H208a4,4,0,0,1,4,4Zm-84-92a24,24,0,0,0-4,47.66V184a4,4,0,0,0,8,0V163.66A24,24,0,0,0,128,116Zm0,40a16,16,0,1,1,16-16A16,16,0,0,1,128,156Z"}))]]),b=t.forwardRef((n,a)=>t.createElement(H,{ref:a,...n,weights:y}));b.displayName="ArrowSquareOutIcon";const A=t.forwardRef((n,a)=>t.createElement(H,{ref:a,...n,weights:M}));A.displayName="LockKeyIcon";function S({onSubmit:n,isLoading:a=!1}){const[l,r]=t.useState(""),[c,m]=t.useState(null),[d,x]=t.useState(!1),u=async i=>{i.preventDefault(),m(null),x(!1);const o=await n(l.trim());o.success?(x(!0),r("")):m(o.error||"Failed to save token")};return e.jsxs("form",{onSubmit:u,className:"space-y-5",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"token",className:"mb-2 block text-sm font-medium text-fg",children:"Personal Access Token"}),e.jsx("input",{id:"token",type:"password",value:l,onChange:i=>r(i.target.value),placeholder:"ghp_xxxxxxxxxxxxxxxxxxxx",className:p("w-full rounded-lg border border-border bg-bg px-3.5 py-2.5 font-mono text-sm","text-fg placeholder:text-muted/40","focus:border-accent focus:outline-hidden focus:ring-1 focus:ring-accent","transition-colors"),disabled:a})]}),c&&e.jsxs("div",{className:"flex items-center gap-2 text-sm text-status-err",children:[e.jsx(N,{className:"size-4 shrink-0",weight:"fill"}),c]}),d&&e.jsxs("div",{className:"flex items-center gap-2 text-sm text-status-ok",children:[e.jsx(v,{className:"size-4 shrink-0",weight:"fill"}),"Token saved"]}),e.jsxs("button",{type:"submit",disabled:a||!l.trim(),className:p("inline-flex items-center gap-2 rounded-lg px-5 py-2.5 text-sm font-medium transition-colors","bg-accent text-accent-fg","hover:bg-accent-hover","disabled:cursor-not-allowed disabled:opacity-40"),children:[a&&e.jsx(g,{className:"size-4 animate-spin"}),"Save Token"]})]})}const _=E(function(){const[a,l]=t.useState(null),[r,c]=t.useState([]),[m,d]=t.useState(!0),[x,u]=t.useState(!1),[i,o]=t.useState(!1),f=t.useCallback(async()=>{d(!0);const s=await h.get("/github/token");s.error||l(s.data),d(!1)},[]),V=t.useCallback(async()=>{u(!0);const s=await h.get("/github/repos");!s.error&&s.data&&c(s.data),u(!1)},[]);t.useEffect(()=>{f()},[f]),t.useEffect(()=>{a!=null&&a.configured&&(a!=null&&a.valid)&&V()},[a,V]);const Z=async s=>{o(!0);const j=await h.post("/github/token",{token:s});return o(!1),j.error?{success:!1,error:j.error}:(await f(),{success:!0})},k=async()=>{await h.delete("/github/token"),l({configured:!1}),c([])};return m?e.jsx("div",{className:"flex items-center justify-center py-24",children:e.jsx(g,{className:"size-7 animate-spin text-muted"})}):e.jsxs("div",{className:"mx-auto max-w-2xl",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-xl font-semibold text-fg",children:"GitHub"}),e.jsx("p",{className:"mt-1 text-sm text-muted",children:"Configure a Personal Access Token to access repositories."})]}),a!=null&&a.configured?e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"rounded-xl border border-border bg-surface/50 p-5",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[a.valid?e.jsx(v,{className:"size-6 text-status-ok",weight:"fill"}):e.jsx(N,{className:"size-6 text-status-err",weight:"fill"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-fg",children:a.valid?"Token configured":"Token invalid"}),a.valid&&a.user&&e.jsxs("p",{className:"mt-0.5 text-sm text-muted",children:["Authenticated as"," ",e.jsx("span",{className:"font-mono text-accent",children:a.user})]}),!a.valid&&a.error&&e.jsx("p",{className:"mt-0.5 text-sm text-status-err",children:a.error})]})]}),e.jsxs("button",{type:"button",onClick:k,className:p("inline-flex items-center gap-1.5 rounded-lg px-2.5 py-1.5 text-xs font-medium transition-colors","text-destructive/70 hover:bg-destructive/10 hover:text-destructive"),children:[e.jsx(w,{className:"size-4"}),"Remove"]})]}),a.valid&&a.scopes&&a.scopes.length>0&&e.jsxs("div",{className:"mt-4 border-t border-border pt-4",children:[e.jsx("p",{className:"mb-2 text-xs font-medium text-muted",children:"Scopes"}),e.jsx("div",{className:"flex flex-wrap gap-1.5",children:a.scopes.map(s=>e.jsx("span",{className:"rounded-md bg-surface px-2 py-1 font-mono text-xs text-muted",children:s},s))})]})]}),a.valid&&e.jsxs("div",{children:[e.jsx("h2",{className:"mb-4 text-sm font-semibold text-fg",children:"Repositories"}),x?e.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted",children:[e.jsx(g,{className:"size-4 animate-spin"}),"Loading..."]}):r.length===0?e.jsx("p",{className:"text-sm text-muted",children:"No repositories found."}):e.jsxs("div",{className:"flex flex-col gap-px overflow-hidden rounded-xl border border-border",children:[r.slice(0,10).map(s=>e.jsxs("div",{className:"flex items-center justify-between bg-surface/50 px-4 py-3 transition-colors hover:bg-surface",children:[e.jsxs("div",{className:"flex min-w-0 items-center gap-3",children:[s.isPrivate&&e.jsx(A,{className:"size-4 shrink-0 text-muted/50"}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("p",{className:"truncate text-sm font-medium text-fg",children:s.fullName}),s.description&&e.jsx("p",{className:"mt-0.5 truncate text-xs text-muted",children:s.description})]})]}),e.jsx("a",{href:s.htmlUrl,target:"_blank",rel:"noopener noreferrer",className:"shrink-0 text-muted/50 transition-colors hover:text-fg",children:e.jsx(b,{className:"size-[18px]"})})]},s.id)),r.length>10&&e.jsxs("div",{className:"bg-surface/30 px-4 py-2.5 text-xs text-muted",children:["And ",r.length-10," more"]})]})]})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"rounded-xl border border-border bg-surface/50 p-5",children:[e.jsx("h3",{className:"mb-3 text-sm font-semibold text-fg",children:"Create a Personal Access Token"}),e.jsxs("ol",{className:"mb-5 list-inside list-decimal space-y-2 text-sm text-muted",children:[e.jsxs("li",{children:["Go to"," ",e.jsx("a",{href:"https://github.com/settings/tokens?type=beta",target:"_blank",rel:"noopener noreferrer",className:"text-accent underline decoration-accent/30 underline-offset-2 hover:decoration-accent",children:"GitHub Token Settings"})]}),e.jsx("li",{children:"Click “Generate new token” (fine-grained)"}),e.jsx("li",{children:"Set expiration and select repositories"}),e.jsxs("li",{children:["Grant permissions:",e.jsx("span",{className:"ml-1 font-mono text-xs text-accent",children:"contents:rw metadata:r"})]}),e.jsx("li",{children:"Generate and paste below"})]}),e.jsxs("a",{href:"https://github.com/settings/tokens?type=beta",target:"_blank",rel:"noopener noreferrer",className:p("inline-flex items-center gap-2 rounded-lg px-4 py-2 text-sm font-medium transition-colors","bg-surface text-fg hover:bg-surface-hover"),children:[e.jsx(b,{className:"size-4"}),"Open GitHub Settings"]})]}),e.jsx("div",{className:"rounded-xl border border-border bg-surface/50 p-5",children:e.jsx(S,{onSubmit:Z,isLoading:i})})]})]})});export{_ as default};
